-- MASTER HUB (teleport melhorado que procura a "base" no workspace)

local Players = game:GetService("Players")
local player = Players.LocalPlayer

local MASTER_USER = "Master hub-OFC"

if player.Name ~= MASTER_USER and player.DisplayName ~= MASTER_USER then
    warn("Você não tem permissão para usar o MASTER HUB")
    return
end

local playerGui = player:WaitForChild("PlayerGui")

-- GUI principal (compacta)
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MasterHubGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 220, 0, 70)
mainFrame.Position = UDim2.new(0, 10, 0, 50)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local titleLabel = Instance.new("TextLabel")
titleLabel.Text = "MASTER HUB"
titleLabel.Size = UDim2.new(0.7, 0, 1, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.TextColor3 = Color3.fromRGB(0, 170, 255)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 20
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = mainFrame

-- Botão TP
local tpBtn = Instance.new("TextButton")
tpBtn.Text = "TP"
tpBtn.Size = UDim2.new(0.25, 0, 1, 0)
tpBtn.Position = UDim2.new(0.7, 0, 0, 0)
tpBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
tpBtn.TextColor3 = Color3.new(1, 1, 1)
tpBtn.Font = Enum.Font.GothamBold
tpBtn.TextSize = 20
tpBtn.Parent = mainFrame

-- Janela TP (compacta)
local tpWindow = Instance.new("Frame")
tpWindow.Size = UDim2.new(0, 180, 0, 80)
tpWindow.Position = UDim2.new(0.5, -90, 0.5, -40)
tpWindow.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
tpWindow.BorderSizePixel = 0
tpWindow.Visible = false
tpWindow.Parent = playerGui
tpWindow.ZIndex = 1000

local tpTitle = Instance.new("TextLabel")
tpTitle.Text = "TP"
tpTitle.Size = UDim2.new(1, 0, 0, 25)
tpTitle.BackgroundTransparency = 1
tpTitle.TextColor3 = Color3.fromRGB(0, 170, 255)
tpTitle.Font = Enum.Font.GothamBold
tpTitle.TextSize = 20
tpTitle.Parent = tpWindow

local tpConfirmBtn = Instance.new("TextButton")
tpConfirmBtn.Text = "Confirmar"
tpConfirmBtn.Size = UDim2.new(0.8, 0, 0, 30)
tpConfirmBtn.Position = UDim2.new(0.1, 0, 0.5, 0)
tpConfirmBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
tpConfirmBtn.TextColor3 = Color3.new(1, 1, 1)
tpConfirmBtn.Font = Enum.Font.GothamBold
tpConfirmBtn.TextSize = 18
tpConfirmBtn.Parent = tpWindow

local closeBtn = Instance.new("TextButton")
closeBtn.Text = "X"
closeBtn.Size = UDim2.new(0, 20, 0, 20)
closeBtn.Position = UDim2.new(1, -25, 0, 5)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 16
closeBtn.Parent = tpWindow

closeBtn.MouseButton1Click:Connect(function()
    tpWindow.Visible = false
end)

tpBtn.MouseButton1Click:Connect(function()
    tpWindow.Visible = not tpWindow.Visible
end)

-- Tela preta para efeito de TP
local blackScreen = Instance.new("Frame")
blackScreen.BackgroundColor3 = Color3.new(0, 0, 0)
blackScreen.Size = UDim2.new(1, 0, 1, 0)
blackScreen.Position = UDim2.new(0, 0, 0, 0)
blackScreen.Visible = false
blackScreen.ZIndex = 1001
blackScreen.Parent = playerGui

-- Funções de busca da "base" (tenta várias estratégias)
local function isBaseLikeName(name)
    if not name then return false end
    local lower = string.lower(name)
    return lower:find("base") or lower:find("sua base") or lower:find("sua_base") or lower:find("casa") or lower:find("plataforma") or lower:find("platform")
end

local function findDescendantBase(root)
    for _,desc in ipairs(root:GetDescendants()) do
        if desc:IsA("BasePart") or desc:IsA("Model") or desc:IsA("Folder") then
            if isBaseLikeName(desc.Name) then
                return desc
            end
        end
    end
    return nil
end

local function findPlayerBase(pl)
    -- 1) Procura por um model/pasta com o nome do jogador em workspace
    local container = workspace:FindFirstChild(pl.Name)
    if container then
        -- procura direto por "Sua Base" ou variações
        local direct = container:FindFirstChild("Sua Base") or container:FindFirstChild("SuaBase") or container:FindFirstChild("Base")
        if direct then return direct end
        -- procura descendentes dentro do container
        local foundInContainer = findDescendantBase(container)
        if foundInContainer then return foundInContainer end
    end

    -- 2) Procura por qualquer modelo em workspace que contenha "base" ou contenha o nome do jogador
    for _,child in ipairs(workspace:GetChildren()) do
        if child:IsA("Model") or child:IsA("Folder") then
            if string.lower(child.Name):find(string.lower(pl.Name)) or isBaseLikeName(child.Name) then
                -- verifica se dentro desse model há partes
                local f = findDescendantBase(child)
                if f then return child end
            end
        elseif child:IsA("BasePart") then
            if isBaseLikeName(child.Name) then
                return child
            end
        end
    end

    -- 3) Se nada foi encontrado, tenta procurar qualquer objeto nomeado "Sua Base" em todo workspace
    for _,desc in ipairs(workspace:GetDescendants()) do
        if isBaseLikeName(desc.Name) then
            return desc
        end
    end

    return nil
end

-- Calcula um CFrame acima do "topo" do model/parte (usa bounds dos BaseParts)
local function getTopCFrameFromInstance(inst, extraHeight)
    extraHeight = extraHeight or 5
    local parts = {}

    if inst:IsA("BasePart") then
        parts = {inst}
    else
        for _,d in ipairs(inst:GetDescendants()) do
            if d:IsA("BasePart") then
                table.insert(parts, d)
            end
        end
    end

    if #parts == 0 then return nil end

    local minX, minY, minZ = math.huge, math.huge, math.huge
    local maxX, maxY, maxZ = -math.huge, -math.huge, -math.huge

    for _,p in ipairs(parts) do
        local pos = p.Position
        local size = p.Size
        local partMinX = pos.X - size.X/2
        local partMaxX = pos.X + size.X/2
        local partMinY = pos.Y - size.Y/2
        local partMaxY = pos.Y + size.Y/2
        local partMinZ = pos.Z - size.Z/2
        local partMaxZ = pos.Z + size.Z/2

        if partMinX < minX then minX = partMinX end
        if partMinY < minY then minY = partMinY end
        if partMinZ < minZ then minZ = partMinZ end
        if partMaxX > maxX then maxX = partMaxX end
        if partMaxY > maxY then maxY = partMaxY end
        if partMaxZ > maxZ then maxZ = partMaxZ end
    end

    local centerX = (minX + maxX)/2
    local centerZ = (minZ + maxZ)/2
    local topY = maxY

    return CFrame.new(centerX, topY + extraHeight, centerZ)
end

-- Teleporta o jogador para a base encontrada (tenta várias estratégias)
local function teleportToBaseForPlayer(pl)
    local baseInst = findPlayerBase(pl)
    if not baseInst then
        warn("Não encontrei a base no workspace. Diga o nome exato do objeto da base (ex.: 'Sua Base') ou mande onde ela fica.")
        return false
    end

    local targetCFrame = getTopCFrameFromInstance(baseInst, 5)
    if not targetCFrame then
        warn("Não foi possível calcular posição acima da base (sem BaseParts encontrados).")
        return false
    end

    -- teleporta personagem para cima da base
    local char = pl.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        -- Ajuste: coloca o personagem 3 studs acima do topo pra não colidir
        char.HumanoidRootPart.CFrame = targetCFrame + Vector3.new(0, 3, 0)
        return true
    end

    return false
end

-- Ação confirmada do TP (botão)
tpConfirmBtn.MouseButton1Click:Connect(function()
    blackScreen.Visible = true
    wait(1.2) -- breve "fade"
    local ok = teleportToBaseForPlayer(player)
    wait(0.5)
    blackScreen.Visible = false
    if not ok then
        tpWindow.Visible = true -- reabre para tentar de novo / ver aviso
    else
        tpWindow.Visible = false
    end
end)

-- Botões Speed / Jump
local speedBtn = Instance.new("TextButton")
speedBtn.Text = "Velocidade"
speedBtn.Size = UDim2.new(0.25, 0, 1, 0)
speedBtn.Position = UDim2.new(0.7, 0, 0, 40)
speedBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
speedBtn.TextColor3 = Color3.new(1, 1, 1)
speedBtn.Font = Enum.Font.GothamBold
speedBtn.TextSize = 18
speedBtn.Parent = mainFrame

local speedActive = false
speedBtn.MouseButton1Click:Connect(function()
    speedActive = not speedActive
    local character = player.Character
    if character and character:FindFirstChild("Humanoid") then
        if speedActive then
            character.Humanoid.WalkSpeed = 250
            speedBtn.Text = "Velocidade ON"
        else
            pcall(function() character.Humanoid.WalkSpeed = 16 end)
            speedBtn.Text = "Velocidade"
        end
    end
end)

local jumpBtn = Instance.new("TextButton")
jumpBtn.Text = "Super Pulo"
jumpBtn.Size = UDim2.new(0.25, 0, 1, 0)
jumpBtn.Position = UDim2.new(0.7, 0, 0, 80)
jumpBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
jumpBtn.TextColor3 = Color3.new(1, 1, 1)
jumpBtn.Font = Enum.Font.GothamBold
jumpBtn.TextSize = 18
jumpBtn.Parent = mainFrame

local jumpActive = false
jumpBtn.MouseButton1Click:Connect(function()
    jumpActive = not jumpActive
    local character = player.Character
    if character and character:FindFirstChild("Humanoid") then
        if jumpActive then
            -- JumpPower alto para alcançar o 3º andar (ajuste se necessário)
            pcall(function() character.Humanoid.JumpPower = 140 end)
            jumpBtn.Text = "Super Pulo ON"
        else
            pcall(function() character.Humanoid.JumpPower = 50 end)
            jumpBtn.Text = "Super Pulo"
        end
    end
end)

-- FIM

                
